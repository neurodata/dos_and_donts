---
title: "Plot Unweighted SIEM Sims"
output: html_document
---

```{r, message=FALSE}
require(ggplot2)
require(gridExtra)
require(grid)
require(tidyverse)
```

# Unweighted Plots

## Prepare Data for Plotting

```{r}
gr.dat <- read.csv('./data/uwt_simulations.csv') %>%
  mutate(Row=factor(Row), Column=factor(Column), Weight=factor(Weight), 
         Method=factor(Method, levels=c("SBM", "SIEM", "rSBM"), ordered=TRUE))
hmap.dat <- read.csv('./data/uwt_power_map.csv') %>%
  mutate(n=factor(n, levels=sort(unique(n)), ordered=TRUE),
         Effect_Size=factor(Effect_Size, levels=sort(unique(Effect_Size)), ordered=TRUE)) %>%
   filter(Simulation != "nSBM")
fixedn.dat <- hmap.dat %>%
  filter(n == 56)
```

## Sim Plots

```{r, fig.width=2.5, fig.height=6}
uw.sim.plt <- ggplot(data=gr.dat, mapping=aes(x=Row, y=Column, fill=Weight)) +
   geom_tile() +
   facet_grid("Method~.", switch="y") +
   xlab("Vertex 1") + 
   ylab("Vertex 2") + 
   scale_x_discrete(breaks=c(1, 50)) + 
   scale_y_discrete(breaks=c(1, 50), limits=rev(levels(gr.dat$Column))) +
   scale_fill_manual(values=c(`0`="white", `1`="purple")) +
   theme_bw() +
   ggtitle("(I) Simulations") +
   guides(fill="none")
uw.sim.plt
```

## HMap Plots

```{r, fig.width=12, fig.height=6}
uw.hmap.plt <- ggplot(data=hmap.dat, mapping=aes(x=n, y=Effect_Size, fill=power)) +
   geom_tile() + 
   facet_grid("Simulation ~ Test") + 
   xlab("Number of Vertices") + 
   ylab("Effect Size") + 
   scale_fill_gradient(high="darkgreen", low="red", name="Power", breaks=c(0, .5, 1)) + 
   scale_x_discrete(breaks=c(20, 100)) + 
   scale_y_discrete(breaks=c(0,1)) + 
   theme_bw() + 
   ggtitle("(II) Power Maps") +
   theme(strip.background.y = element_blank(), strip.text.y = element_blank())
uw.hmap.plt
```

## Fixed n Plots

```{r, fig.width=4, fig.height=6}
alpha=.05
uw.fixedn.plt <- ggplot(data=fixedn.dat, mapping=aes(x=as.numeric(Effect_Size), y=power,
                                                        color=factor(Test), group=factor(Test))) + 
   geom_line() +
   facet_grid("Simulation~.") +
   xlab("Relative Effect Size") +
   ylab("Power") +
   scale_x_continuous(breaks=c(1, 5.5, 10), labels=c(0,.5, 1)) +
   scale_y_continuous(limits=c(0,1), breaks=c(0,1)) +
   scale_color_discrete(name="Test") +
   geom_hline(mapping=aes(yintercept=alpha)) +
   theme_bw() +
   ggtitle("(III) Power Plots, n=56") +
   theme(strip.background = element_blank(), strip.text.y = element_blank())
uw.fixedn.plt
```

## Multiplot

Figure size is 5.5 x 15 inches

```{r, fig.height=6, fig.width=17}
grid.arrange(uw.sim.plt, uw.hmap.plt, uw.fixedn.plt, nrow=1, widths=c(1.1, 5, 1.6))
```